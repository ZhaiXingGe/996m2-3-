人物属性
修改人物名称

changehumname

参数	类型	空	默认	注释
play	object	否		玩家对象
name	string	否		要查询的名字
result	object			执行结果：
0-改名成功
1、2、6-名称被过滤
3-名字已经存在
5-长度不符合要求
7-改名失败
1. 会先执行查询人物名称操作，并触发：queryinghumname;
2. 会根据查询结果情况触发：humnamefilter（名称被过滤）、namelengthfail（长度不符合要求）、humnameexists（名称已经存在）;
3. 执行改名操作前触发：changeinghumname，根据改名结果触发：changehumnameok(改名成功)、changehumnamefail(改名失败)。



--正在查询玩家名称
function queryinghumname(actor)
    sendmsg(actor, 1, '{"Msg":"<font color=\'#ff0000\'>正在查询请稍后。。。</font>","Type":9}')
end



--名称被过滤
function humnamefilter(actor)
    sendmsg(actor, 1, '{"Msg":"<font color=\'#ff0000\'>名称被过滤。。。</font>","Type":9}')
end



--长度不符合要求
function namelengthfail(actor)
    sendmsg(actor, 1, '{"Msg":"<font color=\'#ff0000\'>长度不符合要求</font>","Type":9}')
end



--名称已经存在
function humnameexists(actor)
    sendmsg(actor, 1, '{"Msg":"<font color=\'#ff0000\'>名称已经存在</font>","Type":9}')
end



--正在执行改名操作
function changeinghumname(actor)
    sendmsg(actor, 1, '{"Msg":"<font color=\'#ff0000\'>正在修改请稍后。。。</font>","Type":9}')
end



--改名成功
function changehumnameok(actor)
    sendmsg(actor, 1, '{"Msg":"<font color=\'#ff0000\'>'..parsetext("你的名字修改成功，旧名称：<$USERNAME> 新名称：<$USERNEWNAME>！",actor)..'</font>","Type":9}')
end



--改名失败
function changehumnamefail(actor)
    sendmsg(actor, 1, '{"Msg":"<font color=\'#ff0000\'>修改名称失败</font>","Type":9}')
end

修改人物名字颜色

changenamecolor

参数	类型	空	默认	注释
play	object	否		玩家对象
color	object	否		颜色索引
刷新人物属性

recalcabilitys

参数	类型	空	默认	注释
play	object	否		玩家对象
获取人物属性

gethumability

参数	类型	空	默认	注释
play	object	否		玩家对象
id	int	否		属性ID（1-20）
result	int	否		返回值，对应的属性值
调整人物属性

changehumability

参数	类型	空	默认	注释
play	object	否		玩家对象
id	int	否		属性ID（1-20）
value	int	否		属性值
time	int	否		时间(秒)
属性ID
1=防御下限
2=防御上限
3=魔御下限
4=魔御上限
5=攻击下限
6=攻击上限
7=魔法下限
8=魔法上限
9=道术下限
10=道术上限
11=MaxHP
12=MaxMP
13=HP恢复
14=MP恢复
15=毒恢复
16=毒躲避
17=魔法躲避
18=准确
19=敏捷
20= 幸运
修改人物临时属性（带有效期）

changehumnewvalue

参数	类型	空	默认	注释
play	object	否		玩家对象
nWhere	int	否		位置 对应cfg_att_score 属性ID
nValue	int	否		对应属性值
nTime	int	否		有效时间，秒
function main(self)
    changehumnewvalue(self,10,10,10)
end

获取人物临时属性

gethumnewvalue

参数	类型	空	默认	注释
play	object	否		玩家对象
nWhere	int	否		位置 对应cfg_att_score 属性ID
result	int	否		对应属性值
获取人物永久属性

getusebonuspoint

参数	类型	空	默认	注释
play	object	否		玩家对象
nIndex	int	否		索引
result	int	否		对应属性值
设置人物永久属性

setusebonuspoint

参数	类型	空	默认	注释
play	object	否		玩家对象
nIndex	int	否		索引
nvalue	int	否		对应属性值
nIndex 取值
1：攻击下限（0~65535）
2：攻击上限（0~65535）
3：魔法下限（0~65535）
4：魔法上限（0~65535）
5：道术下限（0~65535）
6：道术上限（0~65535）
7：防御下限（0~65535）
8：防御上限（0~65535）
9：魔防下限（0~65535）
10：魔防上限（0~65535）
11：生命值（支持21亿）
12：魔法值（支持21亿）
13：准确（支持21亿）
14：躲避（支持21亿）
15：防御下限（支持21亿）
16：防御上限（支持21亿）
17：魔防下限（支持21亿）
18：魔防上限（支持21亿）
获取人物标记/标识值

getflagstatus

参数	类型	空	默认	注释
play	object	否		玩家对象
nIndex	int	否		索引（0-799）
result	int	否		对应属性值
设置人物标记/标识值

setflagstatus

参数	类型	空	默认	注释
play	object	否		玩家对象
nIndex	int	否		索引（0-799）
nvalue	int	否		对应属性值
设置人物经验值

changeexp

参数	类型	空	默认	注释
play	object	否		玩家对象
opt	char	否		操作符 + - =
count	int	否		数量
addexp	bool	否		是否增加聚灵珠经验
调整人物等级

changelevel

参数	类型	空	默认	注释
play	object	否		玩家对象
opt	char	否		操作符 + - =
count	int	否		数量
改变人物模式

changemode

参数	类型	空	默认	注释
play	object	否		玩家对象
mode	int	否		模式1~24
time	int	否		时间(秒)
param1	int	否		参数1,12-13，18，20，21代表几率，其余代表属性值
param2	int	否		参数2，代表属性值
具体参考脚本命令说明
//说明: 1=无敌 2=隐身 3=HP 4=MP 5=攻击力 6=魔法力 7=道术力 8=攻击速度 9=禁止攻击 10=锁定
//第三个参数无敌,隐身,禁止攻击时没有使用.
//如果是禁锢时，第三个参数表示禁锢范围
//11 禁锢(释放一个类似困魔咒的光圈，敌对人物或怪物只能在这个圈子里移动，无法走出圈子外面，所有传送失效，不能小退)
//12 冰冻[设置后可以使攻击目标冰冻]
//13 蛛网[设置后可以使攻击目标中蛛网]
//14 防麻痹
//15 防禁锢
//16 防冰冻
//17 防蛛网
//18 麻痹[设置后可以使攻击目标麻痹]
//19 护身
//20 吸血
//21 吸蓝
//22 隐身(类似隐身戒指)
//23 复活
//24 破复活
    --角色无敌，无敌时长60秒
    changemode(actor, 1, 60)





    --禁锢自身10秒,范围3格
    changemode(actor,11, 10, 3)





    --可以使目标冰冻，冰冻机率1(数字越大机率越低)，冰冻时长3秒 
    changemode(actor,12,100,1,3)





    --可以使目标中蛛网，中网机率1(数字越大机率越低)，蛛网时长3秒 
    changemode(actor,13,100,1,3)





    --可以使目标麻痹，麻痹机率1(数字越大机率越低)，麻痹时长3秒 
    changemode(actor,18,100,1,3)

顶戴花翎

seticon

参数	类型	空	默认	注释
play	object	否		玩家对象
where	int	否		位置 0-9
effType	int	否		播放效果
0 = 图片名称
1 = 特效ID
-1 = 取消顶戴
resName	string	否		图片名或者特效ID
x	int	否		X坐标 (为空时默认X=0)
y	int	否		Y坐标 (为空时默认Y=0)
autoDrop	int	否		自动补全空白位置0,1(0=掉 1=不掉)
selfSee	int	否		是否只有自己看见
0=所有人都可见;
1=仅仅自己可见;
posM	int	否	引擎64_23.0628新增	播放位置(不填默认为0)
0=在角色之上;
1=在角色之下;
 --添加顶戴效果
 seticon(actor, 0, 1, 200, -30, 100, 0, 0, 1)





 --移除顶戴效果
 seticon(actor, 0, -1)

在人物身上播放特效

playeffect

参数	类型	空	默认	注释
play	object	否		玩家对象
effectid	int	否		特效ID
offsetX	int	否		相对于人物偏移的X坐标
offsetY	int	否		相对于人物偏移的Y坐标
times	int	否		播放次数
0-一直播放
behind	int	否		播放模式
0-前面
1-后面
selfshow	int	否		仅自己可见
0-否，视野内均可见，
1-是
清除人物身上播放的特效

clearplayeffect

参数	类型	空	默认	注释
play	object	否		玩家对象
effectid	int	否		特效ID
注：已经指定播放数量的特效，不能用此命令清除

修改人物当前血量

humanhp

参数	类型	空	默认	注释
play	object	否		玩家对象
operate	string	否		操作符号
“+” 增加
“-“ 减少
“=” 等于
nvalue	int	否		HP点数
effid	int	否		素材ID
delay	int	否	支持小数	延时时间(秒)
hiter	object	否		伤害来源对象
isSend	int	否		释放广播飘血
0=不广播
1=广播

[[
    参数4 effid = cfg_damage_number表中的ID编号，ID可自行增加和配置
    参数5 delay = 23.0323引擎后支持小数
    参数6 hiter = 伤害来源对象 *0628引擎发布
]]

修改人物当前MP

humanmp

参数	类型	空	默认	注释
play	object	否		玩家对象
operate	string	否		操作符号
‘+’-增加
‘-‘-减少
‘=’-等于
nvalue	integer	否		MP点数
设置人物伤害吸收

setsuckdamage

参数	类型	空	默认	注释
play	object	否		玩家对象
operate	string	否		操作符号
‘+’-增加
‘-‘-减少
‘=’-等于
sum	int	否		总吸收量
rate	int	否		吸收比率，千分比
1=0.1%，100=10%
success	int	否		吸收成功率
人物货币
查询人物货币

querymoney

参数	类型	空	默认	注释
play	object	否		玩家对象
id	int	否		货币ID（1-100）
result	int	否		对应货币值
设置人物货币

changemoney

参数	类型	空	默认	注释
play	object	否		玩家对象
id	int	否		货币ID（1-100）
opt	char	否		操作符 + - =
count	int	否		数量
msg	string	否		备注内容
send	bool	否		是否推送到客户端，true-更新
result	bool	否		是否成功
获取人物通用货币数量(多货币计算)

getbindmoney

参数	类型	空	默认	注释
play	object	否		玩家对象
moneyname	string	否		货币名称
result	int	否		对应货币值
表：cfg_item.xls表，设置方法：Reserved字段 
货币组分类(数字)#优先扣除顺序，如：22#1 22#2 22#3
这3个货币是一个类别的，后面的1 2 3 代表扣除的顺序，数字越小越优先扣除。

扣除人物通用货币数量(多货币依次计算)

consumebindmoney

参数	类型	空	默认	注释
play	object	否		玩家对象
moneyname	string	否		货币名称
count	int	否		对应货币值
msg	string	否	引擎64_23.08.30新增	备注内容
result	bool	否	引擎64_23.12.07新增	是否成功
人物装备
设置人物背包格子数

setbagcount

参数	类型	空	默认	注释
play	object	否		玩家对象
count	int	否		格子大小
获取背包剩余空格数

getbagblank

参数	类型	空	默认	注释
play	object	否		玩家对象
result	integer	否		背包剩余格子数
遍历背包勾选物品

selectbagitems

参数	类型	空	默认	注释
play	object	否		玩家对象
makeindex	string	否		选中的物品唯一ID
多个物品用“,”分隔
穿戴装备

takeonitem

参数	类型	空	默认	注释
play	object	否		玩家对象
where	int	否		位置
makeindex	object	否		物品唯一ID
开/关首饰盒

setsndaitembox

参数	类型	空	默认	注释
play	object	否		玩家对象
bState	integer	否		0：关闭
1：开启
修改武器、衣服外观

changeitemshape

参数	类型	空	默认	注释
play	object	否		玩家对象
item	object	否		物品对象
looks	int	否		外观值
修改武器、衣服特效

changedresseffect

参数	类型	空	默认	注释
play	object	否		玩家对象
where	object	否		位置 0，1
EffId	int	否		特效ID
selfSee	object	否		是否只有自己看见(1=所有人都可见 0=仅仅自己可见)
检测装备的元素属性

checknewitemvalue

参数	类型	空	默认	注释
play	object	否		玩家对象
where	object	否		装备位置：
-1-OK框中的装备
0~55-身上的装备
iAttr	object	否		属性
sFlag	string	否		比较符（=<>）
iValue	object	否		数值(1-100)，百分比
(0)暴击几率增加 1~100%
(1)增加攻击伤害 1~100%
(2)物理伤害减少 1~100%
(3)魔法伤害减少 1~100%
(4)忽视目标防御 1~100%
(5)所有伤害反弹 1~100%
(6)增加目标暴率 1~100%
(7)人物体力增加 1~100%
(8)人物魔力增加 1~100%
(11)暴击伤害增加 1~100%

技能魔法
获取技能信息

getskillinfo

参数	类型	空	默认	注释
play	object	否		玩家对象
skillid	object	否		技能ID
type	object	否	4:熟练度上限
引擎64_23.0628新增	获取类型:
1:等级;
2:强化等级;
3:熟练度;
4:熟练度上限;
result	object	否		返回值(对应属性值) ,没有技能，返回nil
通过技能id获取技能名字

getskillname

参数	类型	空	默认	注释
skillid	integer	否		技能ID
result	string	否		技能名称
通过技能名字获取技能id

getskillindex

参数	类型	空	默认	注释
play	string	否		技能名称
result	integer	否		技能ID
添加技能

addskill

参数	类型	空	默认	注释
play	object	否		玩家对象
skillid	object	否		技能ID
level	object	否		等级
删除技能

delskill

参数	类型	空	默认	注释
play	object	否		玩家对象
skillid	object	否		技能ID
function main(self)
    local lv = getskillinfo(self,11,1)
    if lv and lv >0 then
        delskill(self, 11)
        say(self,"删除雷电术")
    else
        addskill(self, 11, 3)
        say(self,"获得雷电术") 
    end
end

清空所有技能

clearskill

参数	类型	空	默认	注释
play	object	否		玩家对象
删除非本职业技能

delnojobskill

参数	类型	空	默认	注释
play	object	否		玩家对象
设置技能等级

setskillinfo

参数	类型	空	默认	注释
play	object	否		玩家对象
skillid	object	否		技能ID
flag	object	否		类型：
1-技能等级
2-强化等级
3-熟练度
point	object	否		等级或点数
用脚本命令释放技能

releasemagic

参数	类型	空	默认	注释
play	object	否		玩家对象
skillid	object	否		技能ID
type	object	否		类型：
1-普通技能
2-强化技能
level	object	否		技能等级
target	object	否		技能对象：
1-攻击目标，
2-自身
flag	object	否		是否显示施法动作：
0-不显示，1-显示
设置人物攻击威力

powerrate

参数	类型	空	默认	注释
play	object	否		玩家对象
rate	object	否		攻击威力比率，100=100%
time	object	否		有效时间，超过时间恢复正常
增加技能威力

setmagicpower

参数	类型	空	默认	注释
play	object	否		玩家对象
skillname	string	否		技能名称
value	object	否		威力值
type	object	否		计算方式(0按点数计算,1按百分比计算)
增加技能防御力

setmagicdefpower

参数	类型	空	默认	注释
play	object	否		玩家对象
skillname	string	否		技能名称
value	object	否		抵消威力值
type	object	否		计算方式(0按点数计算,1按百分比计算)
function main()
    setmagicdefpower(play,"雷电术",500,0)
end

称号
添加称号

confertitle

参数	类型	空	默认	注释
play	object	否		玩家对象
name	string	否		称号物品名称
use	object	否		开启激活，1激活
result	bool	否		是否成功
function main(self)
    if confertitle(self, '君临天下') then
        say(self,"添加成功")
    else
        say(self,"添加失败")
    end
end

删除称号

deprivetitle

参数	类型	空	默认	注释
play	object	否		玩家对象
name	string	否		称号物品名称
result	bool	否		是否成功
function main(self)
    if deprivetitle(self, '君临天下') then
        say(self,"删除成功")
    else
        say(self,"删除失败")
    end
end

检测人物称号

checktitle

参数	类型	空	默认	注释
play	object	否		玩家对象
title	string	否		称号
result	bool	否		返回值，是否有该称号
获取人物所有称号

gettitlelistinfo

参数	类型	空	默认	注释
play	object	否		玩家对象
id	integer	否		0:idx
1:名称
2:StdMode
3:Shape
4、重量
5、AniCount
6、最大持久
7、叠加数量
8、价格

titlelist	table	否		返回称号列表
完美封号系统

setranklevelname

参数	类型	空	默认	注释
play	object	否		玩家对象
levelname	string	否		称号文本，和名字一起显示
--显示在名字上方
setranklevelname(actor,"%s\\[击杀xx人]")





--显示在名字后方
setranklevelname(actor,"%s[击杀xx人]")

攻击模式
修改攻击模式

changeattackmode

参数	类型	空	默认	注释
play	object	否		玩家对象
attackmode	object	否		攻击模式：
0-全体攻击
1-和平攻击
2-夫妻攻击
3-师徒攻击
4-编组攻击
5-行会攻击
6-红名攻击
7-国家攻击
强制修改攻击模式

setattackmode

参数	类型	空	默认	注释
play	object	否		玩家对象
attackmode	object	否		攻击模式
-1:提前结束强制状态
time	object	否		强制切换时间时间
获取当前攻击模式

getattackmode

参数	类型	空	默认	注释
play	object	否		玩家对象
result	object	否		攻击模式：
0-全体攻击
1-和平攻击
2-夫妻攻击
3-师徒攻击
4-编组攻击
5-行会攻击
6-红名攻击
7-国家攻击
仓库
打开仓库面板

openstorage

参数	类型	空	默认	注释
play	object	否		玩家对象
新解锁仓库格子

最大支持240格 ,cfg_game_data.xls表 字段：warehouse_max_num 设置最大总仓库格子数

changestorage

参数	类型	空	默认	注释
play	object	否		玩家对象
nCount	object	否		新解锁的格子数
更多
跳转地图（随机坐标）

map

参数	类型	空	默认	注释
play	object	否		玩家对象
mapID	string	否		地图ID
飞地图（指定坐标）

mapmove

参数	类型	空	默认	注释
play	object	否		玩家对象
mapID	string	否		地图ID
nX	object	否		X坐标
nY	object	否		Y坐标
nRange	object	否		范围
导航玩家到指定位置

自动寻路到指定坐标

gotonow

参数	类型	空	默认	注释
play	object	否		玩家对象
X	object	否		X坐标
Y	object	否		Y坐标
gotonow(actor,330, 330) 





--QFunction-0.lua





--寻路开启
function findpathbegin(actor)
     release_print("findpathstop",getbaseinfo(actor,1),getconst(actor, "<$ToPointX>"),getconst(actor, "<$ToPointY>"))
end
--寻路中断
function findpathstop(actor)
    release_print("findpathstop",getbaseinfo(actor,1))
end
--寻路结束
function findpathend(actor)
    release_print("findpathend",getbaseinfo(actor,1))
end

遍历玩家列表

getplayerlst

获取所有在线玩家对象

local player_list = getplayerlst()
for i, player  in ipairs(player_list or {}) do
    release_print("在线玩家",i,getbaseinfo(player,1))
end

获取玩家GM权限值

getgmlevel

参数	类型	空	默认	注释
play	object	否		玩家对象
result	object	否		GM权限值
复活

realive

参数	类型	空	默认	注释
play	object	否		玩家对象
人物强制掉线(踢人下线)

kick

参数	类型	空	默认	注释
play	object	否		玩家对象
延时跳转

delaygoto

参数	类型	空	默认	注释
play	object	否		玩家对象
time	object	否		时间(毫秒)
func	string	否		触发函数
del	object	否		换地图是否删除此延时(0或为空时=不删除 1=删除)
    delaygoto(actor,1000,"test_jump,ceshi,44",0)





    --QFunction-0.lua
    function test_jump(actor,...)
        release_print(getbaseinfo(actor,1),...)
    end

删除延迟

cleardelaygoto

参数	类型	空	默认	注释
play	object	否		玩家对象
func	object	否		需要删除的延时函数
不填为清除全部
delaygoto(actor,1000,"test_jump1",0)
cleardelaygoto(actor,"test_jump1")





delaygoto(actor,1000,"test_jump2,1,2,3",0)
cleardelaygoto(actor,"test_jump2,1,2,3")

延时消息跳转

delaymsggoto

参数	类型	空	默认	注释
play	object	否		玩家对象
time	object	否		时间(毫秒)
func	string	否		触发函数

通过消息机制实现延时跳转，允许触发函数内嵌跳转，实现多次跳转，需要传递参数，将参数与函数名使用“,”连接。
本延时跳转不支持删除。

    delaymsggoto(actor, 2000, "@test_jump,ceshi,55")





    --QFunction-0.lua
    function test_jump(actor,...)
        release_print(getbaseinfo(actor,1),...)
    end

人物飘血飘字特效

sendattackeff

参数	类型	空	默认	注释
target	object	否		飘血飘字的主体，一般为受攻击者
type	object	否		显示类型
1- 伤害，
2- 暴击伤害，
4- 加HP，
5- 格挡，
8- 扣减HP和MP，
9- 伤害，
10-扣减MP，
11- 致命一击
对应cfg_damage_number表里的ID
damage	object	否		显示的点数
hitter	object	否		可看到飘血飘字的主体，一般为攻击者
[[
    参数1[target]可以为玩家对象、怪物对象
    参数4[hitter]可以传入字符串“*”表示该飘血飘字特效为广播特效，即视野范围内玩家均可见
]]
sendattackeff(monobj,1,999,"*")

设定人物攻击飘血飘字类型

setattackefftype

参数	类型	空	默认	注释
play	object	否		玩家对象
type	object	否		显示类型
1- 伤害，
2- 暴击伤害，
4- 加HP，
5- 格挡，
8- 扣减HP和MP，
9- 伤害，
10-扣减MP，
11- 致命一击
对应cfg_damage_number表里的ID
设定人物飘血飘字类型，传入参数为攻击者，当前攻击飘血时有效，一次设定后，即返回默认值

停止自动挂机

stopautoattack

参数	类型	空	默认	注释
play	object	否		玩家对象
采集挖矿等进度条操作

showprogressbardlg

参数	类型	空	默认	注释
play	object	否		玩家对象
time	object	否		进度条时间，秒
succ	string	否		成功后跳转的函数
msg	string	否		提示消息
canstop	object	否		能否中断
0-不可中断
1-可以中断
fail	string	否		中断触发的函数
showprogressbardlg(actor,5,"@func_1","进度条测试..", 1,"@func_2")




[[注:跳转函数不能附带参数]]
function func_1(actor)
    release_print("func_1",getbaseinfo(actor,1))
end




function func_2(actor)
    release_print("func_2",getbaseinfo(actor,1))
end

改变玩家速度

changespeed

参数	类型	空	默认	注释
play	object	否		玩家对象
type	object	否		速度类型：
1-移动速度
2-攻击速度
3-施法速度
level	object	否		速度等级 -10~10
0-原始速度，
-1时间间隔减少10%
+1时间间隔增加10%
剔除离线挂机角色

tdummy

参数	类型	空	默认	注释
mapID	string	否		地图号,
“*”表示全部地图
level	string	否		剔除等级
低于此等级均剔除
“*”表示所有
count	string	否		最大剔除玩家数
“*”表示所有
人物转生控制

renewlevel

参数	类型	空	默认	注释
play	object	否		玩家对象
rlevel	integer	否		转生次数
一次转多少级(数值范围为1-255)
level	integer	否		转生后等级
代表转生后人物的等级，
0为不改变人物当前等级
num	integer	否		分配点数
转生后可以得到的点数，
此点数可能按比例换成人物属性点
(数值范围 1 - 20000)
调用游戏面板

openhyperlink

参数	类型	空	默认	注释
play	object	否		玩家对象
nId	integer / string	否		面板ID/客户端面板路径
nState	integer	否		0=打开
1=打开面板重复点按钮不会关闭,除非主动点关闭按钮(一般做任务配合新手引导用到)
2=关闭当前面板ID
rankWnd	integer	否	引擎64_23.08.30新增	面板ID(新排行榜用)
isHero	integer	否	引擎64_23.08.30新增	0/nil=玩家
1=英雄(新排行榜用)

跳转面板ID参考如下:

        Equip               = 1,            -- 角色-装备
        State               = 2,            -- 角色-状态
        Attri               = 3,            -- 角色-属性
        Skill               = 4,            -- 角色-技能
        Title               = 5,            -- 角色-装备
        BestRing            = 6,            -- 角色-首饰盒
        Bag                 = 7,            -- 背包
        Stall               = 8,            -- 摆摊
        StoreHot            = 9,            -- 商城-热销
        StoreBeauty         = 10,           -- 商城-装饰
        StoreEngine         = 11,           -- 商城-功能
        StoreFestival       = 12,           -- 商城-节日
        GuildMain           = 13,           -- 行会-主界面
        GuildMember         = 14,           -- 行会成员列表
        GuildList           = 15,           -- 行会列表
        Mail                = 16,           -- 邮件
        Team                = 17,           -- 组队
        NearPlayer          = 18,           -- 附近玩家




        Setting             = 23,           -- 设置
        MiniMap             = 24,           -- 小地图
        SkillSetting        = 25,           -- 技能设置
        StoreRecharge       = 26,           -- 充值
        Auction             = 27,           -- 拍卖行
        Friend              = 28,           -- 好友
        ExitToRole          = 29,           -- 小退
        GuildCreate         = 30,           -- 行会创建
        Guild               = 31,           -- 智能行会界面
        Rank                = 32,           -- 排行榜
        Trade               = 33,           -- 面对面交易 请求
        ForceExitToRole     = 34,           -- 强制小退
        TradingBank         = 35,           -- 交易行
        GuideEnter          = 36,           -- 引导进入
        SuperEquip          = 37,           -- 角色-神装
        HeroEquip           = 41,           -- 英雄-装备
        HeroState           = 42,           -- 英雄-状态
        HeroAttri           = 43,           -- 英雄-属性
        HeroSkill           = 44,           -- 英雄-技能
        HeroTitle           = 45,           -- 英雄-称号
        HeroBestRing        = 46,           -- 英雄-首饰盒
        HeroBag             = 47,           -- 英雄-背包
        HeroSuperEquip      = 48,           -- 英雄-神装
        ReinAttrPoint       = 51,           -- 转生属性点
        Chat                = 52,           -- 聊天
        PCPrivate           = 53,           -- PC 私聊记录页


        MiniMapTransfer     = 60，           -- 小地图传送页签



        MagicJointAttack    = 99,           -- 释放合击




        AssistChange        = 110,          -- 主界面-任务栏
        Box996              = 111,          -- 盒子称号
        MainMiniMapChange   = 112,          -- 小地图伸缩
        PCResolution        = 113,          -- PC 分辨率设置
        ChatExtendEmoj      = 114,          -- 角色-表情
        ChatExtendBag       = 115,          -- 聊天小框-背包
        MainNear            = 116,          -- 主界面-附近列表
        CallPay             = 117,          -- 调用-支付




        SettingBasic        = 300,          -- 基础设置
        SettingWindowRange  = 301,          -- 视距
        SettingFight        = 302,          -- 战斗
        SettingProtect      = 303,          -- 保护
        SettingAuto         = 304,          -- 挂机
        SettingHelp         = 305,          -- 帮助



        KeFu                = 310,          -- 调用客服界面
        Compound            = 2201,         -- 合成

开启自动挂机

startautoplaygame

参数	类型	空	默认	注释
play	object	否		玩家对象
停止自动挂机

stopautoplaygame

参数	类型	空	默认	注释
play	object	否		玩家对象
减少技能CD冷却时间

setskilldeccd

参数	类型	空	默认	注释
play	object	否		玩家对象
skillname	string	否		技能名称
char	string	否		操作符(+/-/=)
=0就是还原技能CD
获取技能初始冷却时间

getskillcscd

参数	类型	空	默认	注释
skillname	string	否		技能名称
result	integer	否		冷却时间(毫秒)
获取当前技能冷却时间

getskilldqcd

参数	类型	空	默认	注释
play	object	否		玩家对象
skillname	string	否		技能名称
result	integer	否		冷却时间(毫秒)
百分比修改速度

changespeedex

参数	类型	空	默认	注释
play	object	否		玩家对象
model	integer	否		计算方式
1=移动速度
2=攻击速度
3=魔法速度
value	integer	否		速度值
100=原速度(大于100=加速
小于100减速)
time	integer	否		有效时间秒(为空=表示不限制时间,最大值65535)
  changespeedex(actor,1,150,65535)

修改人物名字颜色

changenamecolor

参数	类型	空	默认	注释
play	object	否		玩家对象
color	object	否		颜色索引
刷新人物属性

recalcabilitys

参数	类型	空	默认	注释
play	object	否		玩家对象
获取人物属性

gethumability

参数	类型	空	默认	注释
play	object	否		玩家对象
id	object	否		属性ID（1-20）
result	object	否		返回值，对应的属性值
调整人物属性

changehumability

参数	类型	空	默认	注释
play	object	否		玩家对象
id	object	否		属性ID（1-20）
value	object	否		属性值
time	object	否		时间(秒)
属性ID
1=防御下限
2=防御上限
3=魔御下限
4=魔御上限
5=攻击下限
6=攻击上限
7=魔法下限
8=魔法上限
9=道术下限
10=道术上限
11=MaxHP
12=MaxMP
13=HP恢复
14=MP恢复
15=毒恢复
16=毒躲避
17=魔法躲避
18=准确
19=敏捷
20= 幸运
修改人物临时属性（带有效期）

changehumnewvalue

参数	类型	空	默认	注释
play	object	否		玩家对象
nWhere	object	否		位置 对应cfg_att_score 属性ID
nValue	object	否		对应属性值
nTime	object	否		有效时间，秒
function main(self)
    changehumnewvalue(self,10,10,10)
end

获取人物临时属性

gethumnewvalue

参数	类型	空	默认	注释
play	object	否		玩家对象
nWhere	object	否		位置 对应cfg_att_score 属性ID
result	object	否		对应属性值
获取人物永久属性

getusebonuspoint

参数	类型	空	默认	注释
play	object	否		玩家对象
nIndex	object	否		索引
result	object	否		对应属性值
设置人物永久属性

setusebonuspoint

参数	类型	空	默认	注释
play	object	否		玩家对象
nIndex	object	否		索引
nvalue	object	否		对应属性值
nIndex 取值
1：攻击下限（0~65535）
2：攻击上限（0~65535）
3：魔法下限（0~65535）
4：魔法上限（0~65535）
5：道术下限（0~65535）
6：道术上限（0~65535）
7：防御下限（0~65535）
8：防御上限（0~65535）
9：魔防下限（0~65535）
10：魔防上限（0~65535）
11：生命值（支持21亿）
12：魔法值（支持21亿）
13：准确（支持21亿）
14：躲避（支持21亿）
15：防御下限（支持21亿）
16：防御上限（支持21亿）
17：魔防下限（支持21亿）
18：魔防上限（支持21亿）
获取人物标记/标识值

getflagstatus

参数	类型	空	默认	注释
play	object	否		玩家对象
nIndex	object	否		索引（0-799）
result	object	否		对应属性值
设置人物标记/标识值

setflagstatus

参数	类型	空	默认	注释
play	object	否		玩家对象
nIndex	object	否		索引（0-799）
nvalue	object	否		对应属性值
设置人物经验值

changeexp

参数	类型	空	默认	注释
play	object	否		玩家对象
opt	char	否		操作符 + - =
count	object	否		数量
addexp	bool	否		是否增加聚灵珠经验
调整人物等级

changelevel

参数	类型	空	默认	注释
play	object	否		玩家对象
opt	char	否		操作符 + - =
count	object	否		数量
改变人物模式

changemode

参数	类型	空	默认	注释
play	object	否		玩家对象
mode	object	否		模式1~24
time	object	否		时间(秒)
param1	object	否		参数1,12-13，18，20，21代表几率，其余代表属性值
param2	object	否		参数2，代表属性值
具体参考脚本命令说明
//说明: 1=无敌 2=隐身 3=HP 4=MP 5=攻击力 6=魔法力 7=道术力 8=攻击速度 9=禁止攻击 10=锁定
//第三个参数无敌,隐身,禁止攻击时没有使用.
//如果是禁锢时，第三个参数表示禁锢范围
//11 禁锢(释放一个类似困魔咒的光圈，敌对人物或怪物只能在这个圈子里移动，无法走出圈子外面，所有传送失效，不能小退)
//12 冰冻[设置后可以使攻击目标冰冻]
//13 蛛网[设置后可以使攻击目标中蛛网]
//14 防麻痹
//15 防禁锢
//16 防冰冻
//17 防蛛网
//18 麻痹[设置后可以使攻击目标麻痹]
//19 护身
//20 吸血
//21 吸蓝
//22 隐身(类似隐身戒指)
//23 复活
//24 破复活
    --角色无敌，无敌时长60秒
    changemode(actor, 1, 60)





    --禁锢自身10秒,范围3格
    changemode(actor,11, 10, 3)





    --可以使目标冰冻，冰冻机率1(数字越大机率越低)，冰冻时长3秒 
    changemode(actor,12,100,1,3)





    --可以使目标中蛛网，中网机率1(数字越大机率越低)，蛛网时长3秒 
    changemode(actor,13,100,1,3)





    --可以使目标麻痹，麻痹机率1(数字越大机率越低)，麻痹时长3秒 
    changemode(actor,18,100,1,3)

顶戴花翎

seticon

参数	类型	空	默认	注释
play	object	否		玩家对象
where	object	否		位置 0-9
effType	object	否		播放效果
0 = 图片名称
1 = 特效ID
-1 = 取消顶戴
resName	string	否		图片名或者特效ID
x	object	否		X坐标 (为空时默认X=0)
y	object	否		Y坐标 (为空时默认Y=0)
autoDrop	object	否		自动补全空白位置0,1(0=掉 1=不掉)
selfSee	object	否		是否只有自己看见
0=所有人都可见;
1=仅仅自己可见;
posM	object	否	引擎64_23.0628新增	播放位置(不填默认为0)
0=在角色之上;
1=在角色之下;
 --添加顶戴效果
 seticon(actor, 0, 1, 200, -30, 100, 0, 0, 1)





 --移除顶戴效果
 seticon(actor, 0, -1)

在人物身上播放特效

playeffect

参数	类型	空	默认	注释
play	object	否		玩家对象
effectid	object	否		特效ID
offsetX	object	否		相对于人物偏移的X坐标
offsetY	object	否		相对于人物偏移的Y坐标
times	object	否		播放次数
0-一直播放
behind	object	否		播放模式
0-前面
1-后面
selfshow	object	否		仅自己可见
0-否，视野内均可见，
1-是
清除人物身上播放的特效

clearplayeffect

参数	类型	空	默认	注释
play	object	否		玩家对象
effectid	object	否		特效ID
注：已经指定播放数量的特效，不能用此命令清除

修改人物当前血量

humanhp

参数	类型	空	默认	注释
play	object	否		玩家对象
operate	string	否		操作符号
“+” 增加
“-“ 减少
“=” 等于
nvalue	object	否		HP点数
effid	object	否		素材ID
delay	object	否	引擎64_23.03.23后
支持小数	延时时间(秒)
hiter	object	否	引擎64_23.06.28新增	伤害来源对象
isSend	object	否	引擎64_23.10.24新增	释放广播飘血
0=不广播
1=广播
[[
    参数4 effid = cfg_damage_number表中的ID编号，ID可自行增加和配置
    参数5 delay = 23.0323引擎后支持小数
    参数6 hiter = 伤害来源对象 *0628引擎发布
]]

设置人物伤害吸收

setsuckdamage

参数	类型	空	默认	注释
play	object	否		玩家对象
operate	string	否		操作符号
‘+’-增加
‘-‘-减少
‘=’-等于
sum	object	否		总吸收量
rate	object	否		吸收比率，千分比
1=0.1%，100=10%
success	object	否		吸收成功率
人物货币
查询人物货币

querymoney

参数	类型	空	默认	注释
play	object	否		玩家对象
id	object	否		货币ID（1-100）
result	object	否		对应货币值
设置人物货币

changemoney

参数	类型	空	默认	注释
play	object	否		玩家对象
id	object	否		货币ID（1-100）
opt	char	否		操作符 + - =
count	object	否		数量
msg	string	否		备注内容
send	bool	否		是否推送到客户端，true-更新
result	bool	否		是否成功
获取人物通用货币数量(多货币计算)

getbindmoney

参数	类型	空	默认	注释
play	object	否		玩家对象
moneyname	string	否		货币名称
result	object	否		对应货币值
表：cfg_item.xls表，设置方法：Reserved字段 
货币组分类(数字)#优先扣除顺序，如：22#1 22#2 22#3
这3个货币是一个类别的，后面的1 2 3 代表扣除的顺序，数字越小越优先扣除。

扣除人物通用货币数量(多货币依次计算)

consumebindmoney

参数	类型	空	默认	注释
play	object	否		玩家对象
moneyname	string	否		货币名称
count	object	否		对应货币值
msg	string	否	引擎64_23.08.30新增	备注内容
result	bool	否	引擎64_23.12.07新增	是否成功
人物装备
设置人物背包格子数

setbagcount

参数	类型	空	默认	注释
play	object	否		玩家对象
count	object	否		格子大小
获取背包剩余空格数

getbagblank

参数	类型	空	默认	注释
play	object	否		玩家对象
result	integer	否		背包剩余格子数
遍历背包勾选物品

selectbagitems

参数	类型	空	默认	注释
play	object	否		玩家对象
makeindex	string	否		选中的物品唯一ID
多个物品用“,”分隔
穿戴装备

takeonitem

参数	类型	空	默认	注释
play	object	否		玩家对象
where	object	否		位置
makeindex	object	否		物品唯一ID
开/关首饰盒

setsndaitembox

参数	类型	空	默认	注释
play	object	否		玩家对象
bState	integer	否		0：关闭
1：开启
修改武器、衣服外观

changeitemshape

参数	类型	空	默认	注释
play	object	否		玩家对象
item	object	否		物品对象
looks	object	否		外观值
修改武器、衣服特效

changedresseffect

参数	类型	空	默认	注释
play	object	否		玩家对象
where	object	否		位置 0，1
EffId	object	否		特效ID
selfSee	object	否		是否只有自己看见(1=所有人都可见 0=仅仅自己可见)
检测装备的元素属性

checknewitemvalue

参数	类型	空	默认	注释
play	object	否		玩家对象
where	object	否		装备位置：
-1-OK框中的装备
0~55-身上的装备
iAttr	object	否		属性
sFlag	string	否		比较符（=<>）
iValue	object	否		数值(1-100)，百分比
(0)暴击几率增加 1~100%
(1)增加攻击伤害 1~100%
(2)物理伤害减少 1~100%
(3)魔法伤害减少 1~100%
(4)忽视目标防御 1~100%
(5)所有伤害反弹 1~100%
(6)增加目标暴率 1~100%
(7)人物体力增加 1~100%
(8)人物魔力增加 1~100%
(11)暴击伤害增加 1~100%

技能魔法
获取技能信息

getskillinfo

参数	类型	空	默认	注释
play	object	否		玩家对象
skillid	object	否		技能ID
type	object	否	4:熟练度上限
引擎64_23.0628新增	获取类型:
1:等级;
2:强化等级;
3:熟练度;
4:熟练度上限;
result	object	否		返回值(对应属性值) ,没有技能，返回nil
添加技能

addskill

参数	类型	空	默认	注释
play	object	否		玩家对象
skillid	object	否		技能ID
level	object	否		等级
删除技能

delskill

参数	类型	空	默认	注释
play	object	否		玩家对象
skillid	object	否		技能ID
function main(self)
    local lv = getskillinfo(self,11,1)
    if lv and lv >0 then
        delskill(self, 11)
        say(self,"删除雷电术")
    else
        addskill(self, 11, 3)
        say(self,"获得雷电术") 
    end
end

清空所有技能

clearskill

参数	类型	空	默认	注释
play	object	否		玩家对象
删除非本职业技能

delnojobskill

参数	类型	空	默认	注释
play	object	否		玩家对象
获取技能等级

getskilllevel

参数	类型	空	默认	注释
play	object	否		玩家对象
skillid	integer	否		技能ID
设置技能等级

setskillinfo

参数	类型	空	默认	注释
play	object	否		玩家对象
skillid	integer	否		技能ID
flag	object	否		类型：
1-技能等级
2-强化等级
3-熟练度
point	object	否		等级或点数
用脚本命令释放技能

releasemagic

参数	类型	空	默认	注释
play	object	否		玩家对象
skillid	object	否		技能ID
type	object	否		类型：
1-普通技能
2-强化技能
level	object	否		技能等级
target	object	否		技能对象：
1-攻击目标，
2-自身
flag	object	否		是否显示施法动作：
0-不显示，1-显示
设置人物攻击威力

powerrate

参数	类型	空	默认	注释
play	object	否		玩家对象
rate	object	否		攻击威力比率，100=100%
time	object	否		有效时间，超过时间恢复正常
增加技能威力

setmagicpower

参数	类型	空	默认	注释
play	object	否		玩家对象
skillname	string	否		技能名称
value	object	否		威力值
type	object	否		计算方式(0按点数计算,1按百分比计算)
增加技能防御力

setmagicdefpower

参数	类型	空	默认	注释
play	object	否		玩家对象
skillname	string	否		技能名称
value	object	否		抵消威力值
type	object	否		计算方式(0按点数计算,1按百分比计算)
function main()
    setmagicdefpower(play,"雷电术",500,0)
end

获取玩家对象
根据玩家名称

getplayerbyname

参数	类型	空	默认	注释
name	string	否		玩家名字
result	object	否		玩家对象
根据玩家唯一ID

getplayerbyid

参数	类型	空	默认	注释
id	string	否		玩家唯一id
result	object	否		玩家对象
称号
添加称号

confertitle

参数	类型	空	默认	注释
play	object	否		玩家对象
name	string	否		称号物品名称
use	object	否		开启激活，1激活
result	bool	否		是否成功
function main(self)
    if confertitle(self, '君临天下') then
        say(self,"添加成功")
    else
        say(self,"添加失败")
    end
end

删除称号

deprivetitle

参数	类型	空	默认	注释
play	object	否		玩家对象
name	string	否		称号物品名称
result	bool	否		是否成功
function main(self)
    if deprivetitle(self, '君临天下') then
        say(self,"删除成功")
    else
        say(self,"删除失败")
    end
end

检测人物称号

checktitle

参数	类型	空	默认	注释
play	object	否		玩家对象
title	string	否		称号
result	bool	否		返回值，是否有该称号
获取人物所有称号

gettitlelistinfo

参数	类型	空	默认	注释
play	object	否		玩家对象
id	integer	否		0:idx
1:名称
2:StdMode
3:Shape
4、重量
5、AniCount
6、最大持久
7、叠加数量
8、价格

titlelist	table	否		返回称号列表
完美封号系统

setranklevelname

参数	类型	空	默认	注释
play	object	否		玩家对象
levelname	string	否		称号文本，和名字一起显示
--显示在名字上方
setranklevelname(actor,"%s\\[击杀xx人]")





--显示在名字后方
setranklevelname(actor,"%s[击杀xx人]")

攻击模式
修改攻击模式

changeattackmode

参数	类型	空	默认	注释
play	object	否		玩家对象
attackmode	object	否		攻击模式：
0-全体攻击
1-和平攻击
2-夫妻攻击
3-师徒攻击
4-编组攻击
5-行会攻击
6-红名攻击
7-国家攻击
强制修改攻击模式

setattackmode

参数	类型	空	默认	注释
play	object	否		玩家对象
attackmode	object	否		攻击模式
-1:提前结束强制状态
time	object	否		强制切换时间时间
获取当前攻击模式

getattackmode

参数	类型	空	默认	注释
play	object	否		玩家对象
result	object	否		攻击模式：
0-全体攻击
1-和平攻击
2-夫妻攻击
3-师徒攻击
4-编组攻击
5-行会攻击
6-红名攻击
7-国家攻击
仓库
打开仓库面板

openstorage

参数	类型	空	默认	注释
play	object	否		玩家对象
新解锁仓库格子

最大支持240格 ,cfg_game_data.xls表 字段：warehouse_max_num 设置最大总仓库格子数

changestorage

参数	类型	空	默认	注释
play	object	否		玩家对象
nCount	object	否		新解锁的格子数
更多
跳转地图（随机坐标）

map

参数	类型	空	默认	注释
play	object	否		玩家对象
mapID	string	否		地图ID
飞地图（指定坐标）

mapmove

参数	类型	空	默认	注释
play	object	否		玩家对象
mapID	string	否		地图ID
nX	object	否		X坐标
nY	object	否		Y坐标
nRange	object	否		范围
导航玩家到指定位置

自动寻路到指定坐标

gotonow

参数	类型	空	默认	注释
play	object	否		玩家对象
X	object	否		X坐标
Y	object	否		Y坐标
gotonow(actor,330, 330) 





--QFunction-0.lua





--寻路开启
function findpathbegin(actor)
     release_print("findpathstop",getbaseinfo(actor,1),getconst(actor, "<$ToPointX>"),getconst(actor, "<$ToPointY>"))
end
--寻路中断
function findpathstop(actor)
    release_print("findpathstop",getbaseinfo(actor,1))
end
--寻路结束
function findpathend(actor)
    release_print("findpathend",getbaseinfo(actor,1))
end

遍历玩家列表

getplayerlst

获取所有在线玩家对象

local player_list = getplayerlst()
for i, player  in ipairs(player_list or {}) do
    release_print("在线玩家",i,getbaseinfo(player,1))
end

获取玩家GM权限值

getgmlevel

参数	类型	空	默认	注释
play	object	否		玩家对象
result	object	否		GM权限值
复活

realive

参数	类型	空	默认	注释
play	object	否		玩家对象
人物强制掉线(踢人下线)

kick

参数	类型	空	默认	注释
play	object	否		玩家对象
延时跳转

delaygoto

参数	类型	空	默认	注释
play	object	否		玩家对象
time	object	否		时间(毫秒)
func	string	否		触发函数
del	object	否		换地图是否删除此延时(0或为空时=不删除 1=删除)
    delaygoto(actor,1000,"test_jump,ceshi,44",0)





    --QFunction-0.lua
    function test_jump(actor,...)
        release_print(getbaseinfo(actor,1),...)
    end

删除延迟

cleardelaygoto

参数	类型	空	默认	注释
play	object	否		玩家对象
func	object	否		需要删除的延时函数
不填为清除全部
delaygoto(actor,1000,"test_jump1",0)
cleardelaygoto(actor,"test_jump1")





delaygoto(actor,1000,"test_jump2,1,2,3",0)
cleardelaygoto(actor,"test_jump2,1,2,3")

延时消息跳转

delaymsggoto

参数	类型	空	默认	注释
play	object	否		玩家对象
time	object	否		时间(毫秒)
func	string	否		触发函数

通过消息机制实现延时跳转，允许触发函数内嵌跳转，实现多次跳转，需要传递参数，将参数与函数名使用“,”连接。
本延时跳转不支持删除。

    delaymsggoto(actor, 2000, "@test_jump,ceshi,55")





    --QFunction-0.lua
    function test_jump(actor,...)
        release_print(getbaseinfo(actor,1),...)
    end

增加附加伤害效果

rangeharm

参数	类型	空	默认	注释
play	object	否		玩家对象
targetX	object	否		X坐标
targetY	object	否		Y坐标
range	object	否		影响范围
power	object	否		攻击力
addtype	object	否		附加类型：0.无,1.击退,2.冻结,
3.麻痹,4.吸血,5.吸蓝,
6.真实伤害数值,7.蛛网效果,8.红毒,
9.绿毒,10.定身,11.防禁锢,
12.最大hp百分比真实伤害,
13.当前hp百分比真实伤害
addvalue	object	否		附加属性值：
1.击退距离;2.冻结时间;
3.麻痹时间;4.吸血值;
5.吸蓝值;6.真实伤害值;
7.蛛网时间;8;红毒时间;
9.绿毒时间;
10.定身时间(定身时间单位是毫秒);
11.防禁锢时间(秒);
12.最大hp百分比真实伤害的值;
13.当前hp百分比真实伤害的值
checkstate	object	否		是否检查防冻结/麻痹/石化/冰冻/蛛网/红毒/绿毒属性
0=直接设置状态;1=检查后设置状态)
targettype	object	否		目标类型(0或空=所有目标;1=仅人物;2=仅怪物)
effectid	object	否		目标身上播放的特效ID
harmNum	object	否	引擎64_23.0628新增	群体伤害目标个数
人物飘血飘字特效

sendattackeff

参数	类型	空	默认	注释
target	object	否		飘血飘字的主体，一般为受攻击者
type	object	否		显示类型
1- 伤害，
2- 暴击伤害，
4- 加HP，
5- 格挡，
8- 扣减HP和MP，
9- 伤害，
10-扣减MP，
11- 致命一击
对应cfg_damage_number表里的ID
damage	object	否		显示的点数
hitter	object	否		可看到飘血飘字的主体，一般为攻击者
[[
    参数1[target]可以为玩家对象、怪物对象
    参数4[hitter]可以传入字符串“*”表示该飘血飘字特效为广播特效，即视野范围内玩家均可见
]]
sendattackeff(monobj,1,999,"*")

设定人物攻击飘血飘字类型

setattackefftype

参数	类型	空	默认	注释
play	object	否		玩家对象
type	object	否		显示类型
1- 伤害，
2- 暴击伤害，
4- 加HP，
5- 格挡，
8- 扣减HP和MP，
9- 伤害，
10-扣减MP，
11- 致命一击
对应cfg_damage_number表里的ID
设定人物飘血飘字类型，传入参数为攻击者，当前攻击飘血时有效，一次设定后，即返回默认值

停止自动挂机

stopautoattack

参数	类型	空	默认	注释
play	object	否		玩家对象
采集挖矿等进度条操作

showprogressbardlg

参数	类型	空	默认	注释
play	object	否		玩家对象
time	object	否		进度条时间，秒
succ	string	否		成功后跳转的函数
msg	string	否		提示消息
canstop	object	否		能否中断
0-不可中断
1-可以中断
fail	string	否		中断触发的函数
showprogressbardlg(actor,5,"@func_1","进度条测试..", 1,"@func_2")




[[注:跳转函数不能附带参数]]
function func_1(actor)
    release_print("func_1",getbaseinfo(actor,1))
end




function func_2(actor)
    release_print("func_2",getbaseinfo(actor,1))
end

改变玩家速度

changespeed

参数	类型	空	默认	注释
play	object	否		玩家对象
type	object	否		速度类型：
1-移动速度
2-攻击速度
3-施法速度
level	object	否		速度等级 -10~10
0-原始速度，
-1时间间隔减少10%
+1时间间隔增加10%
剔除离线挂机角色

tdummy

参数	类型	空	默认	注释
mapID	string	否		地图号,
“*”表示全部地图
level	string	否		剔除等级
低于此等级均剔除
“*”表示所有
count	string	否		最大剔除玩家数
“*”表示所有
设置玩家GM权限值

setgmlevel

参数	类型	空	默认	注释
play	object	否		玩家对象
gmlevel	integer	否		GM权限值
调用游戏面板

openhyperlink

参数	类型	空	默认	注释
play	object	否		玩家对象
nId	integer	否		面板ID
nState	integer	否		0=打开
1=打开面板重复点按钮不会关闭,除非主动点关闭按钮(一般做任务配合新手引导用到)
2=关闭当前面板ID
rankWnd	integer	否	引擎64_23.08.30新增	面板ID(新排行榜用)
isHero	integer	否	引擎64_23.08.30新增	0/nil=玩家
1=英雄(新排行榜用)

跳转面板ID参考如下:

        Equip               = 1,            -- 角色-装备
        State               = 2,            -- 角色-状态
        Attri               = 3,            -- 角色-属性
        Skill               = 4,            -- 角色-技能
        Title               = 5,            -- 角色-装备
        BestRing            = 6,            -- 角色-首饰盒
        Bag                 = 7,            -- 背包
        Stall               = 8,            -- 摆摊
        StoreHot            = 9,            -- 商城-热销
        StoreBeauty         = 10,           -- 商城-装饰
        StoreEngine         = 11,           -- 商城-功能
        StoreFestival       = 12,           -- 商城-节日
        GuildMain           = 13,           -- 行会-主界面
        GuildMember         = 14,           -- 行会成员列表
        GuildList           = 15,           -- 行会列表
        Mail                = 16,           -- 邮件
        Team                = 17,           -- 组队
        NearPlayer          = 18,           -- 附近玩家




        Setting             = 23,           -- 设置
        MiniMap             = 24,           -- 小地图
        SkillSetting        = 25,           -- 技能设置
        StoreRecharge       = 26,           -- 充值
        Auction             = 27,           -- 拍卖行
        Friend              = 28,           -- 好友
        ExitToRole          = 29,           -- 小退
        GuildCreate         = 30,           -- 行会创建
        Guild               = 31,           -- 智能行会界面
        Rank                = 32,           -- 排行榜
        Trade               = 33,           -- 面对面交易 请求
        ForceExitToRole     = 34,           -- 强制小退
        TradingBank         = 35,           -- 交易行
        GuideEnter          = 36,           -- 引导进入
        SuperEquip          = 37,           -- 角色-神装
        HeroEquip           = 41,           -- 英雄-装备
        HeroState           = 42,           -- 英雄-状态
        HeroAttri           = 43,           -- 英雄-属性
        HeroSkill           = 44,           -- 英雄-技能
        HeroTitle           = 45,           -- 英雄-称号
        HeroBestRing        = 46,           -- 英雄-首饰盒
        HeroBag             = 47,           -- 英雄-背包
        HeroSuperEquip      = 48,           -- 英雄-神装
        ReinAttrPoint       = 51,           -- 转生属性点
        Chat                = 52,           -- 聊天
        PCPrivate           = 53,           -- PC 私聊记录页


        MiniMapTransfer     = 60，           -- 小地图传送页签



        MagicJointAttack    = 99,           -- 释放合击




        AssistChange        = 110,          -- 主界面-任务栏
        Box996              = 111,          -- 盒子称号
        MainMiniMapChange   = 112,          -- 小地图伸缩
        PCResolution        = 113,          -- PC 分辨率设置
        ChatExtendEmoj      = 114,          -- 角色-表情
        ChatExtendBag       = 115,          -- 聊天小框-背包
        MainNear            = 116,          -- 主界面-附近列表
        CallPay             = 117,          -- 调用-支付




        SettingBasic        = 300,          -- 基础设置
        SettingWindowRange  = 301,          -- 视距
        SettingFight        = 302,          -- 战斗
        SettingProtect      = 303,          -- 保护
        SettingAuto         = 304,          -- 挂机
        SettingHelp         = 305,          -- 帮助



        KeFu                = 310,          -- 调用客服界面
        Compound            = 2201,         -- 合成

减少技能CD冷却时间

setskilldeccd

参数	类型	空	默认	注释
play	object	否		玩家对象
skillname	string	否		技能名称
char	string	否		操作符(+/-/=)
=0就是还原技能CD
获取技能初始冷却时间

getskillcscd

参数	类型	空	默认	注释
skillname	string	否		技能名称
result	integer	否		冷却时间(毫秒)
获取当前技能冷却时间

getskilldqcd

参数	类型	空	默认	注释
play	object	否		玩家对象
skillname	string	否		技能名称
result	integer	否		冷却时间(毫秒)
重置技能冷却时间

skillrestcd

参数	类型	空	默认	注释
actor	object	否		玩家对象
skillName/skillID	string/integer	否		技能名称/技能ID
time	integer	否		减免的cd时间
传入0则重置技能CD
timeType	integer	否		0=时间单位为秒
1=时间单位为毫秒
骰子功能

playdice

参数	类型	空	默认	注释
player	object	否		玩家对象
num	integer	否		动画数量
比如3就是会出现3个骰子转动
funcName	string	否		动画结束触发
      [[骰子的显示顺序和点数 对应 私人变量 D0 D1 D2 D3 D4 D5]]
    setplaydef(actor, "D0",1)
    setplaydef(actor, "D1",2)
    setplaydef(actor, "D2",3)
    setplaydef(actor, "D3",4)
    setplaydef(actor, "D4",5)
    setplaydef(actor, "D5",6)
    playdice(actor,1,"@test_jump,传参")


    -- QFunction-0.lua
    function test_jump(actor,...)
        release_print("test_jump,qf",getbaseinfo(actor,1),...)
    end

通过字符串增加对应属性值

addattlist

参数	类型	空	默认	注释
play	object	否		玩家对象
attridx	string	否		自定义属性组名称
opt	string	否		操作符 +、-、=
attrStr	string	否		属性字符串
type	integer	否		0或空=
计算套装属性增加 1=
增加固定值;
不计算套装属性
(属性加成类无效)
    --加属性
    addattlist(actor,"属性组1","+","3#1#100|3#2#100|3#3#10|3#4#10")

获取字符串属性

getattlist

参数	类型	空	默认	注释
play	object	否		玩家对象
attridx	string	否		自定义属性组名称
result	string	否		属性字符串
    local attr_str = getattlist(actor,"自定义属性组1")
    release_print("attr_str",attr_str)

改变技能特效

setmagicskillefft

参数	类型	空	默认	注释
play	object	否		玩家对象
skillName	string	否		技能名称
effectID	string	否		特效id,=0为关闭
(cfg_skill_present.xls表id)
effectID2	integer	否		持续性ID(魔法盾BUFF表id/
火墙/群体雷电术/
其他的技能无效)
    setmagicskillefft(actor,"雷电术", 33)

开启/关闭时装外显

clientshowfashion

参数	类型	空	默认	注释
play	object	否		玩家对象
state	integer	否		0:关闭时装外显
1:开启时装外显
婚戒互飞接口

clienttranstospouse

参数	类型	空	默认	注释
play	object	否		玩家对象
修改目标血量/蓝量扩展接口

humanhpex
humanmpex

参数	类型	空	默认	注释
object	object	否		目标对象
opt	string	否		操作符 +/-
num	integer	否		血量值
type	integer	否		类型
0:数值
1:百分比
interval	integer	否		时间间隔（秒）
times	integer	否		执行次数
id	integer	是		飘血素材
cfg_damage_number表中的ID
maxhp	integer	是		加减hp的最大值
-- 人物每隔1秒钟减少自身血量10%，共执行5次，且减少血量的最大值不超过100点，飘血素材为1
humanhpex(actor, "-", 10, 1, 1, 5, 1, 100)

获取玩家pk等级

getpklevel

参数	类型	空	默认	注释
play	object	否		玩家对象
result	integer	否		pk等级
0.白名;1.黄名;2.红名;
判断对象是否可被攻击

ispropertarget

参数	类型	空	默认	注释
Hiter	object	否		攻击对象
(玩家/英雄)
Target	object	否		被攻击对象
(玩家/英雄)
Result	boolean	否		返回值
true:可以被攻击
false:不可被攻击
立即推送前端变量

sendredvartoclient

参数	类型	空	默认	注释
play	object	否		玩家对象
骑马相关
设置马的外观

sethorseappr

参数	类型	空	默认	注释
play	object	否		玩家对象
id	integer	否		马匹外观ID（0为清除）
上马

ridehorse

参数	类型	空	默认	注释
play	object	否		玩家对象
下马

dismounthorse

参数	类型	空	默认	注释
play	object	否		玩家对象
其他
人物(怪物)变色

setbodycolor

参数	类型	空	默认	注释
obj	object	否		目标对象
color	integer	否		颜色(0~255); 255时清除颜色
-1则为转生设置的颜色在人物身体上进行变色
time	integer	否		改变时长(秒)
设置等级锁

setlocklevel

参数	类型	空	默认	注释
actor	object	否		玩家对象
itype	integer	否		0:解除锁定
1锁定到达最大等级时并且不获取怪物经验
2:锁定到达最大等级时累积经验(int64)
level	integer	否		锁住最大等级
获取玩家在对应排行榜页签中的排名

getrankorder

注：玩家名不存在或者玩家未上榜返回值为-1
参数	类型	空	默认	注释
name	string	否		查询的玩家名
rankid	integer	否		排行榜页签
0=全榜
1=战士榜
2=法师榜
3=道士榜
Result	integer	否		返回值
增加气泡

addbutshow

参数	类型	空	默认	注释
actor	object	否		玩家对象
ID	integer	否		ID
name	string	否		显示名称
fun	fun	否		函数名
(多参数用逗号分割)
方法名只能以diyfunc_开头
addbutshow(actor,1,"测试气泡","@diyfunc_test,参数1,参数2,参数3")


function diyfunc_test(actor,...)
    release_print(...)
end

删除气泡

delbutshow

参数	类型	空	默认	注释
actor	object	否		玩家对象
ID	integer	否		ID
调整HP(血量)的百分比

addhpper

参数	类型	空	默认	注释
actor	object	否		玩家(怪物)对象
opt	string	否		控制符(=,+,-)
value	integer	否		数值
effectid	integer	否		飘血调用ID
（cfg_damage_number.xls表）
isSend	integer	是	0	是否广播飘血特效(填1表示广播)
调整MP(蓝量)的百分比

addmpper

参数	类型	空	默认	注释
actor	object	否		玩家对象
opt	string	否		控制符(=,+,-)
value	integer	否		数值
吸怪功能

monmove

参数	类型	空	默认	注释
actor	object	否		玩家对象
max	integer	否		最大范围
min	integer	否		最小范围
monLevel	integer	否		怪物等级
=0则嘲讽/吸引所以级别怪物
type	integer	否		0=不嘲讽玩家
1=嘲讽玩家
isMove	integer	否		0=怪物漂移到人物边
1=怪物瞬移到目前人物坐标
2=怪物瞬移到目前人物面前
unLimit	integer	否		最大范围
1=怪物人物攻击目标不归属自己的不可被吸
monmove(actor,10, 2, 0, 0, 2, 0)

修改角色外观(武器、衣服、特效)

setfeature

参数	类型	空	默认	注释
actor	object	否		玩家对象
type	integer	否		0=衣服;1=武器;
2=衣服特效(翅膀);
3=武器特效;
4=盾牌;5=盾牌特效
6=左手武器;7=左手武器特效
shape	integer	否		外观的shape(角色模型ID),-1表示清除
time	integer	否		时间 (秒,int64)
param1	integer	否		仅在参数1位置为0时有效
0=覆盖时装外观
1=时装外观优先
param2	integer	否		仅在参数1位置为0时有效
0-斗笠、头发不变
1-隐藏斗笠
2-隐藏头发
3-隐藏斗笠和头发
设置装备部位属性加成(万分比)

setequipaddvalue

参数	类型	空	默认	注释
actor	object	否		玩家对象
where	integer	否		装备部位
sFlag	string	否		操作符(=,+,-)
pro	integer	否		倍数(万分比)
setequipaddvalue(actor,1 ,"+", 15000)
say(actor,"武器部位的属性加成".. getequipaddvalue(actor,1))

获取装备部位属性加成(万分比)

getequipaddvalue

参数	类型	空	默认	注释
actor	object	否		玩家对象
where	integer	否		装备部位
result	integer	否		倍数(万分比)